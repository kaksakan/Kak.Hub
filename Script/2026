local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local PlaceId = game.PlaceId
local Camera = workspace.CurrentCamera
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local PlaceId = game.PlaceId
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local PunchEvent = ReplicatedStorage:WaitForChild("Events"):WaitForChild("Punch")
_G.Toggles = _G.Toggles or {}
local Backpack = LocalPlayer:FindFirstChild("Backpack")

if PlaceId == 4866692557 then

   local AgeOfHeroesWINDOW = Rayfield:CreateWindow({
   Name = "Age Of Heroes",
   Icon = "flame",
   LoadingTitle = "Kak.Hub",
   LoadingSubtitle = "By Kak",
   ShowText = "Kak.Hub",
   Theme = "Default",

   ToggleUIKeybind = "K",

   DisableRayfieldPrompts = true,
   DisableBuildWarnings = true,
   
   })

   local Tab1 = AgeOfHeroesWINDOW:CreateTab("NPC Farms", "repeat-2")

   local Toggles = {}

   local function GetTarget(mode)
      local target = nil
      local dist = math.huge
      
      for _, v in pairs(Workspace:GetChildren()) do
         local isMatch = false
         if mode == "+Reputation" and v.Name == "Thug" then
               isMatch = true
         elseif mode == "-Reputation" and (v.Name == "Civilian" or v.Name == "Police") then
               isMatch = true
         elseif mode == "Level" and (v.Name == "Thug" or v.Name == "Civilian" or v.Name == "Police") then
               isMatch = true
         end

         if isMatch and v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 then
               local root = v:FindFirstChild("HumanoidRootPart")
               local myRoot = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
               
               if root and myRoot then
                  local magnitude = (root.Position - myRoot.Position).Magnitude
                  if magnitude < dist then
                     dist = magnitude
                     target = v
                  end
               end
         end
      end
      return target
   end

   local function StartFarm(mode)
      task.spawn(function()
         while _G.CurrentFarm == mode do
               local target = GetTarget(mode)
               
               if target then
                  while _G.CurrentFarm == mode and target and target.Parent and target.Humanoid.Health > 0 do
                     local myRoot = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                     local targetRoot = target:FindFirstChild("HumanoidRootPart")
                     if myRoot and targetRoot then
                           myRoot.CFrame = targetRoot.CFrame
                     end
                     RunService.Heartbeat:Wait()
                  end
               end
               task.wait(0.5)
         end
      end)

      task.spawn(function()
         while _G.CurrentFarm == mode do
               for _, args in ipairs(punchSequences) do
                  if _G.CurrentFarm ~= mode then break end
                  PunchEvent:FireServer(unpack(args))
                  task.wait(0.2)
               end
               task.wait(0.1)
         end
      end)
   end

   function AutoMetalSkin()
      args = {"metalSkin", true}
      game:GetService("ReplicatedStorage"):WaitForChild("Events"):WaitForChild("Transform"):FireServer(unpack(args))
   end   

   Toggles.Toggle1 = Tab1:CreateToggle({
      Name = "+Reputation Farm",
      CurrentValue = false,
      Flag = "Toggles.Toggle1",
      Callback = function(Value)
         if Value then
               AutoMetalSkin()
               Toggles.Toggle2:Set(false)
               Toggles.Toggle3:Set(false)
               _G.CurrentFarm = "+Reputation"
               StartFarm("+Reputation")
         else
               if _G.CurrentFarm == "+Reputation" then _G.CurrentFarm = nil end
         end
      end,
   })

   Toggles.Toggle2 = Tab1:CreateToggle({
      Name = "-Reputation Farm",
      CurrentValue = false,
      Flag = "Toggles.Toggle2",
      Callback = function(Value)
         if Value then
               AutoMetalSkin()
               Toggles.Toggle1:Set(false)
               Toggles.Toggle3:Set(false)
               _G.CurrentFarm = "-Reputation"
               StartFarm("-Reputation")
         else
               if _G.CurrentFarm == "-Reputation" then _G.CurrentFarm = nil end
         end
      end,
   })

   Toggles.Toggle3 = Tab1:CreateToggle({
      Name = "Level Farm",
      CurrentValue = false,
      Flag = "Toggles.Toggle3",
      Callback = function(Value)
         if Value then
               AutoMetalSkin()
               Toggles.Toggle1:Set(false)
               Toggles.Toggle2:Set(false)
               _G.CurrentFarm = "Level"
               StartFarm("Level")
         else
               if _G.CurrentFarm == "Level" then _G.CurrentFarm = nil end
         end
      end,
   })

   local Tab2 = AgeOfHeroesWINDOW:CreateTab("Toggles", "power")

   local Toggles = {}

   local function SetNoclip(state)
   local character = LocalPlayer.Character
   if not character then return end

   for _, part in ipairs(character:GetDescendants()) do
      if part:IsA("BasePart") then
         part.CanCollide = not state
         end
      end
   end

   Toggles.Toggle1 = Tab2:CreateToggle({
      Name = "Noclip",
      CurrentValue = false,
      Flag = "Toggles.Toggle1",
      Callback = function(Value)
         if Value then
           NoclipConnection = RunService.Stepped:Connect(function()
               SetNoclip(true)
            end)
         else
            if NoclipConnection then
               NoclipConnection:Disconnect()
               NoclipConnection = nil
            end

            SetNoclip(false)
         end
      end,
   })

   
   MetalSkinConnection = MetalSkinConnection or nil

   Toggles.Toggle2 = Tab2:CreateToggle({
      Name = "Auto Metal Skin",
      CurrentValue = true,
      Flag = "Toggles.Toggle2",
      Callback = function(Value)
         
         if MetalSkinConnection then 
               MetalSkinConnection:Disconnect() 
               MetalSkinConnection = nil 
         end
         
         if Value then
               AutoMetalSkin()
               
               MetalSkinConnection = LocalPlayer.CharacterAdded:Connect(function()
                  task.wait(2)
                  AutoMetalSkin()
               end)
         end
      end,
   })

   if Toggles.Toggle2.CurrentValue == true then
      AutoMetalSkin()
      
      if not MetalSkinConnection then
         MetalSkinConnection = LocalPlayer.CharacterAdded:Connect(function()
               task.wait(2)
               AutoMetalSkin()
         end)
      end
   end

   local StableSequences = {
    {0.5, 0.01, 1},
    {0.5, 0.01, 2},
    {0.5, 0.01, 3},
    {0.5, 0.01, 4},
    {0.5, 0.01, 5}
   }

   local ActiveLoop = false

   function StartAutoPunch()
      if ActiveLoop then return end
      ActiveLoop = true
      
      task.spawn(function()
         while _G.AutoPunch do
               if _G.energy then _G.energy = math.huge end
               _G.lastAttack = 0
               _G.lastAction = 0 
               
               if PunchEvent then
                  PunchEvent:FireServer(0.5, 0.01, 1) 
                  task.wait(0.06) 
               else
                  task.wait(1)
               end
         end
         ActiveLoop = false
      end)
   end

   Toggles.Toggle3 = Tab2:CreateToggle({
   Name = "Auto Punch",
   CurrentValue = false,
   Flag = "Toggles.Toggle3",
   Callback = function(Value)
      _G.AutoPunch = Value
      if Value then
         StartAutoPunch()
      end
   end
   })

   ReputationSaverConnection = nil
   SafeLocation = CFrame.new(-384.850037, 96.7103348, 356, 0, 0, 1, 0, 1, -0, -1, 0, 0)

   Toggles.Toggle4 = Tab2:CreateToggle({
      Name = "Reputation Saver",
      CurrentValue = false,
      Flag = "Toggles.Toggle4",
      Callback = function(Value)
         if ReputationSaverConnection then 
               ReputationSaverConnection:Disconnect() 
               ReputationSaverConnection = nil 
         end

         if Value then
               ReputationSaverConnection = game:GetService("RunService").Heartbeat:Connect(function()
                  local player = game:GetService("Players").LocalPlayer
                  local char = player.Character
                  local humanoid = char and char:FindFirstChild("Humanoid")
                  local rootPart = char and char:FindFirstChild("HumanoidRootPart")
                  local leaderstats = player:FindFirstChild("leaderstats")
                  local rep = leaderstats and leaderstats:FindFirstChild("Reputation")

                  if humanoid and rootPart and rep and rep.Value >= 10000 then
                     if humanoid.Health > 0 and humanoid.Health < (humanoid.MaxHealth * 0.3) then
                           rootPart.CFrame = SaveLocation
                           humanoid.WalkSpeed = 0
                           humanoid.JumpPower = 0
                     elseif humanoid.Health >= (humanoid.MaxHealth * 0.3) then
                           if humanoid.WalkSpeed == 0 then
                              humanoid.WalkSpeed = 16
                              humanoid.JumpPower = 50
                           end
                     end
                  end
               end)
         else
               local humanoid = game:GetService("Players").LocalPlayer.Character and game:GetService("Players").LocalPlayer.Character:FindFirstChild("Humanoid")
               if humanoid then
                  humanoid.WalkSpeed = 16
                  humanoid.JumpPower = 50
               end
         end
      end
   })

   local AutoCollectRunning = false
   local AutoCollectThread = nil

   local OrbFolder = workspace:WaitForChild("ExperienceOrbs")
   local CachedOrbs = {}

   local function RegisterOrb(obj)
      if obj.Name ~= "experienceOrb" then return end

      if obj:IsA("BasePart") or obj:IsA("Model") then
         table.insert(CachedOrbs, obj)
      end
   end

   for _, v in ipairs(OrbFolder:GetChildren()) do
      RegisterOrb(v)
   end

   OrbFolder.ChildAdded:Connect(RegisterOrb)

   local function CollectOrbsOnce()
      local char = LocalPlayer.Character
      local hrp = char and char:FindFirstChild("HumanoidRootPart")
      
      if not hrp then return end

      for i = #CachedOrbs, 1, -1 do
         local orb = CachedOrbs[i]

         if not orb or not orb.Parent then
               table.remove(CachedOrbs, i)
               continue
         end

         local targetCFrame = hrp.CFrame * CFrame.new(0, 0, -1)

         if orb:IsA("BasePart") then
               orb.CFrame = targetCFrame
               orb.AssemblyLinearVelocity = Vector3.new(0, 0, 0) 
         elseif orb:IsA("Model") then
               orb:PivotTo(targetCFrame)
         end
      end
   end

   Toggles.Toggle5 = Tab2:CreateToggle({
      Name = "Auto Collect XP Orbs",
      CurrentValue = false,
      Flag = "Toggles.Toggle4",
      Callback = function(Value)
         if Value then
            if AutoCollectRunning then return end
            AutoCollectRunning = true

            AutoCollectThread = task.spawn(function()
               while AutoCollectRunning do
                  CollectOrbsOnce()
                  task.wait(30)
               end
            end)
         else
            AutoCollectRunning = false
         end
      end,
   })

   local InfiniteJumpEnabled = false
   local JumpConnection = nil

   Toggles.Toggle6 = Tab2:CreateToggle({
      Name = "Infinite Jumps",
      CurrentValue = false,
      Flag = "Toggles.Toggle5",
      Callback = function(Value)
         InfiniteJumpEnabled = Value

         if Value then
            JumpConnection = UserInputService.JumpRequest:Connect(function()
               if not InfiniteJumpEnabled then return end

               local character = LocalPlayer.Character
               if not character then return end

               local humanoid = character:FindFirstChildOfClass("Humanoid")
               if humanoid then
                  humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
               end
            end)
         else
            if JumpConnection then
               JumpConnection:Disconnect()
               JumpConnection = nil
            end
         end
      end,
   })

   local Tab3 = AgeOfHeroesWINDOW:CreateTab("ESP", "eye")

   local Toggles = {}

   local Dividers = {}

   local ColorPickers = {}

   EspEnabled = false
   EspConnections = {}

   function CleanAndNumber(val)
      if type(val) == "number" then return val end
      local str = tostring(val)
      local cleaned = str:gsub("[^%d%.]", "")
      return tonumber(cleaned) or 0
   end

   function FormatNumber(val)
      local n = CleanAndNumber(val)
      if n >= 1000000 then
         return string.format("%.1fM", n / 1000000)
      elseif n >= 1000 then
         return string.format("%.1fK", n / 1000)
      else
         return tostring(math.floor(n))
      end
   end

   function GetStat(player, statNames)
      local leaderstats = player:FindFirstChild("leaderstats")
      if not leaderstats then return 0 end
      
      for _, name in ipairs(statNames) do
         local stat = leaderstats:FindFirstChild(name)
         if stat then return stat.Value end
      end
      return 0
   end

   function CreateEsp(player)
      if player == LocalPlayer then return end

      local function ApplyEsp(character)
         local head = character:WaitForChild("Head", 10)
         if not head then return end

         -- Eski ESP varsa temizle
         if head:FindFirstChild("EspUI") then head.EspUI:Destroy() end

         local billboard = Instance.new("BillboardGui")
         billboard.Name = "EspUI"
         billboard.Adornee = head
         billboard.Size = UDim2.new(0, 200, 0, 100)
         billboard.StudsOffset = Vector3.new(0, 3, 0)
         billboard.AlwaysOnTop = true
         billboard.Parent = head

         local label = Instance.new("TextLabel")
         label.Parent = billboard
         label.BackgroundTransparency = 1
         label.Size = UDim2.new(1, 0, 1, 0)
         label.TextStrokeTransparency = 0
         label.TextSize = 13
         label.Font = Enum.Font.SourceSansBold
         label.TextColor3 = (player.TeamColor and player.TeamColor.Color) or Color3.new(1, 1, 1)

         -- Canlı Güncelleme Döngüsü
         task.spawn(function()
               while head and head.Parent and billboard and EspEnabled do
                  local char = character
                  local myChar = LocalPlayer.Character
                  
                  if myChar and myChar:FindFirstChild("HumanoidRootPart") and char:FindFirstChild("HumanoidRootPart") then
                     local distance = math.floor((myChar.HumanoidRootPart.Position - char.HumanoidRootPart.Position).Magnitude)
                     
                     local levelVal = GetStat(player, {"Level", "Leveling", "Lvl"})
                     local repVal = GetStat(player, {"Reputation", "Rep", "Bounty"})
                     local moneyVal = GetStat(player, {"Money", "Cash", "Coins", "Yen", "Currency", "Beli"})

                     label.Text = string.format("%s\n[%d Studs]\n[Lvl: %s]\n[Rep: %s]\n[Cash: %s]", 
                           (player.DisplayName or player.Name), 
                           distance, 
                           FormatNumber(levelVal), 
                           FormatNumber(repVal), 
                           FormatNumber(moneyVal)
                     )
                     
                     -- Renk Güncelleme (Takım değişirse)
                     label.TextColor3 = (player.TeamColor and player.TeamColor.Color) or Color3.new(1, 1, 1)
                  end
                  task.wait(0.1) -- Daha akıcı olması için bekleme süresini 0.1 yaptık
               end
               if billboard then billboard:Destroy() end
         end)
      end

      if player.Character then
         ApplyEsp(player.Character)
      end
      
      table.insert(EspConnections, player.CharacterAdded:Connect(ApplyEsp))
   end

   function RemoveEsp()
      EspEnabled = false
      for _, player in ipairs(Players:GetPlayers()) do
         if player.Character and player.Character:FindFirstChild("Head") then
               local ui = player.Character.Head:FindFirstChild("EspUI")
               if ui then ui:Destroy() end
         end
      end
      for _, conn in ipairs(EspConnections) do
         conn:Disconnect()
      end
      EspConnections = {}
   end

   -- Toggle'a Bağlama
   Toggles.Toggle1 = Tab3:CreateToggle({
      Name = "Player ESP",
      CurrentValue = false,
      Flag = "Toggles.Toggle1",
      Callback = function(Value)
         EspEnabled = Value
         if Value then
               for _, player in ipairs(Players:GetPlayers()) do
                  CreateEsp(player)
               end
               table.insert(EspConnections, Players.PlayerAdded:Connect(CreateEsp))
         else
               RemoveEsp()
         end
      end,
   })

   Dividers.Divider1 = Tab3:CreateDivider()

   Toggles.Toggle2 = Tab3:CreateToggle({
   Name = "Highlight ESP",
   CurrentValue = false,
   Flag = "Toggles.Toggle2",
   Callback = function(Value)
         
   end,
   })

   ColorPickers.ColorPicker1 = Tab3:CreateColorPicker({
   Name = "Fill Color Of The Highlight ESP",
   Color = Color3.fromRGB(255,255,255),
   Flag = "ColorPickers.ColorPicker1",
   Callback = function(Value)
   
   end
   })

   Toggles.Toggle3 = Tab3:CreateToggle({
   Name = "No Fill Color",
   CurrentValue = false,
   Flag = "Toggles.Toggle3",
   Callback = function(Value)
         
   end,
   })

   ColorPickers.ColorPicker2 = Tab3:CreateColorPicker({
   Name = "Outline Color Of The HighLight ESP",
   Color = Color3.fromRGB(255,255,255),
   Flag = "ColorPickers.ColorPicker2",
   Callback = function(Value)
   
   end
   })

   Dividers.Divider2 = Tab3:CreateDivider()

   Toggles.Toggle4 = Tab3:CreateToggle({
   Name = "Tracer ESP",
   CurrentValue = false,
   Flag = "Toggles.Toggle4",
   Callback = function(Value)
         
   end,
   })

   ColorPickers.ColorPicker3 = Tab3:CreateColorPicker({
   Name = "Color Of The Tracer ESP",
   Color = Color3.fromRGB(255,255,255),
   Flag = "ColorPickers.ColorPicker3",
   Callback = function(Value)
   
   end
   })

   Toggles.Toggle5 = Tab3:CreateToggle({
   Name = "Rainbow Tracer ESP",
   CurrentValue = false,
   Flag = "Toggles.Toggle5",
   Callback = function(Value)
         
   end,
   })

   Dividers.Divider3 = Tab3:CreateDivider()

   Toggles.Toggle = Tab3:CreateToggle({
   Name = "Thug ESP",
   CurrentValue = false,
   Flag = "Toggles.Toggle6",
   Callback = function(Value)
         
   end,
   })

   Toggles.Toggle6 = Tab3:CreateToggle({
   Name = "Police ESP",
   CurrentValue = false,
   Flag = "Toggles.Toggle7",
   Callback = function(Value)
         
   end,
   })

   Toggles.Toggle8 = Tab3:CreateToggle({
   Name = "Civilian ESP",
   CurrentValue = false,
   Flag = "Toggles.Toggle8",
   Callback = function(Value)
         
   end,
   })

   Dividers.Divider4 = Tab3:CreateDivider()

   Toggles.Toggle9 = Tab3:CreateToggle({
   Name = "XP Orb ESP",
   CurrentValue = false,
   Flag = "Toggles.Toggle9",
   Callback = function(Value)
         
   end,
   })

   local Tab4 = AgeOfHeroesWINDOW:CreateTab("Transportation", "move")

   local Dropdowns = {}
   
   local Buttons = {}

   local Dividers = {}

   local SafeZones = workspace:FindFirstChild("SafeZones")

   local Locations = {}
   local LocationNames = {}

   for i, obj in ipairs(SafeZones:GetChildren()) do
      local name = "Location " .. i
      LocationNames[i] = name
      Locations[name] = obj
   end

   local SelectedLocation

   Dropdowns.Dropdown1 = Tab4:CreateDropdown({
      Name = "Select A Location",
      Options = LocationNames,
      CurrentOption = {},
      MultipleOptions = false,
      Flag = "Dropdowns.Dropdown1",
      Callback = function(opt)
         SelectedLocation = opt[1]
      end,
   })

   local function GetRoot()
      return (LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()):WaitForChild("HumanoidRootPart")
   end

   local function GetCFrame()
      local obj = Locations[SelectedLocation]
      if not obj then return end
      return obj:IsA("Model") and obj:GetPivot() or obj.CFrame
   end

   Buttons.Button1 = Tab4:CreateButton({
      Name = "Teleport To The Selected Location",
      Callback = function()
         local cf = GetCFrame()
         if cf then GetRoot().CFrame = cf end
      end,
   })

   Buttons.Button2 = Tab4:CreateButton({
      Name = "Tween To The Selected Location",
      Callback = function()
         local cf = GetCFrame()
         if not cf then return end

         local root = GetRoot()
         TweenService:Create(
               root,
               TweenInfo.new((root.Position - cf.Position).Magnitude / 300),
               { CFrame = cf }
         ):Play()
      end,
   })

   Dividers.Divider1 = Tab4:CreateDivider()

   Buttons.Button3 = Tab4:CreateButton({
   Name = "Teleport To A Random Player In A Safezone",
   Callback = function()
      local SafeZones = workspace:FindFirstChild("SafeZones")
      local LocalPlayer = game:GetService("Players").LocalPlayer
        
      if not SafeZones then 
         Rayfield:Notify({Title = "Error", Content = "SafeZones folder not found!", Duration = 3})
         return 
      end

      local function IsInBarrier(position, barrier)
         local relativePos = barrier.CFrame:PointToObjectSpace(position)
         local size = barrier.Size / 2
         return math.abs(relativePos.X) <= size.X and
            math.abs(relativePos.Y) <= size.Y and
            math.abs(relativePos.Z) <= size.Z
      end

      local foundTarget = false

      for _, player in ipairs(game:GetService("Players"):GetPlayers()) do
         if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPos = player.Character.HumanoidRootPart.Position
            for _, obj in ipairs(SafeZones:GetChildren()) do
                  if obj.Name == "Barrier" and obj:IsA("BasePart") then
                     if IsInBarrier(rootPos, obj) then
                        LocalPlayer.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame
                        foundTarget = true
                        break
                     end
                  end
               end
         end
         if foundTarget then break end
      end

      if not foundTarget then
         Rayfield:Notify({
            Title = "Not Found",
            Content = "No players found inside SafeZones.",
            Duration = 3,
            Image = "x"
         })
      end
   end,
   })

   local Tab5 = AgeOfHeroesWINDOW:CreateTab("Target", "crosshair")

   local Dropdowns = {}

   local Buttons =  {}

   local Dividers = {}

   local Toggles = {}

   SelectedPlayer = nil

   function GetPlayerNames()
      PlayerList = {}
      for _, player in ipairs(game:GetService("Players"):GetPlayers()) do
         if player ~= game:GetService("Players").LocalPlayer then
               display = player.DisplayName
               username = player.Name
               table.insert(PlayerList, display .. " (" .. username .. ")")
         end
      end
      table.sort(PlayerList)
      return PlayerList
   end

   Dropdowns.Dropdown1 = Tab5:CreateDropdown({
      Name = "Select A Player",
      Options = GetPlayerNames(),
      CurrentOption = {},
      MultipleOptions = false,
      Flag = "Dropdowns.Dropdown1",
      Callback = function(Options)
         Selection = Options[1]
         if Selection then
               SelectedPlayer = Selection:match("%((.-)%)")
         else
               SelectedPlayer = nil
         end
      end,
   })

   Buttons.Button1 = Tab5:CreateButton({
      Name = "Refresh Dropdown",
      Callback = function()
         Dropdowns.Dropdown1:Refresh(GetPlayerNames())
         
         Rayfield:Notify({
               Title = "Refreshed!",
               Content = "Player list has been updated.",
               Duration = 3,
               Image = "rotate-cw"
         })

      end,
   })

   Dividers.Divider1 = Tab5:CreateDivider()

   PlayerLeaveConnection = nil

   Toggles.Toggle1 = Tab5:CreateToggle({
      Name = "Spectate Selected Player",
      CurrentValue = false,
      Flag = "Toggles.Toggle1",
      Callback = function(Value)
         if Value then
               if not SelectedPlayer then
                  Rayfield:Notify({
                     Title = "Error",
                     Content = "Please select a player first.",
                     Duration = 3,
                     Image = "x"
                  })
                  Toggles.Toggle1:Set(false)
                  return
               end

               TargetObj = game:GetService("Players"):FindFirstChild(SelectedPlayer)
               
               if TargetObj and TargetObj.Character and TargetObj.Character:FindFirstChild("Humanoid") then
                  workspace.CurrentCamera.CameraSubject = TargetObj.Character.Humanoid
                  
                  if PlayerLeaveConnection then PlayerLeaveConnection:Disconnect() end
                  PlayerLeaveConnection = game:GetService("Players").PlayerRemoving:Connect(function(player)
                     if player.Name == SelectedPlayer then
                           Toggles.Toggle1:Set(false)
                           Rayfield:Notify({
                              Title = "Target Left",
                              Content = "The player you were spectating has left the game.",
                              Duration = 3,
                              Image = "log-out"
                           })
                     end
                  end)
               else
                  Rayfield:Notify({
                     Title = "Error",
                     Content = "Target player character not found.",
                     Duration = 3,
                     Image = "x"
                  })
                  Toggles.Toggle1:Set(false)
               end
         else
               if PlayerLeaveConnection then 
                  PlayerLeaveConnection:Disconnect() 
                  PlayerLeaveConnection = nil
               end
               
               if game:GetService("Players").LocalPlayer.Character and game:GetService("Players").LocalPlayer.Character:FindFirstChild("Humanoid") then
                  workspace.CurrentCamera.CameraSubject = game:GetService("Players").LocalPlayer.Character.Humanoid
               end
         end
      end,
   })

   function CheckSafeZone(targetChar)
    local isSafe = false
    if workspace:FindFirstChild("SafeZones") then
        for _, barrier in ipairs(workspace.SafeZones:GetChildren()) do
            if barrier.Name == "Barrier" and barrier:IsA("BasePart") then
                local parts = workspace:GetPartsInPart(barrier)
                for _, p in ipairs(parts) do
                    if p:IsDescendantOf(targetChar) then
                        isSafe = true
                        break
                    end
                end
            end
            if isSafe then break end
        end
    end
    return isSafe
   end

   local SafeCFrame = CFrame.new(-384.850037, 96.7103348, 431, 0, 0, 1, 0, 1, -0, -1, 0, 0)

   Toggles.Toggle2 = Tab5:CreateToggle({
      Name = "Kill Selected Player",
      CurrentValue = false,
      Flag = "Toggles.Toggle2",
      Callback = function(Value)
         _G.AutoPunch = Value
            
         if Value then
               if not SelectedPlayer then
                  Rayfield:Notify({
                     Title = "Error",
                     Content = "Please select a player first.",
                     Duration = 3,
                     Image = "x"
                  })
                  Toggles.Toggle2:Set(false)
                  return
               end

               local targetObj = game:GetService("Players"):FindFirstChild(SelectedPlayer)
               local localPlayer = game:GetService("Players").LocalPlayer

               if targetObj and targetObj.Character and targetObj.Character:FindFirstChild("HumanoidRootPart") then
                     
                  if CheckSafeZone(targetObj.Character) then
                     Rayfield:Notify({
                           Title = "Action Denied!",
                           Content = "Target is in a safe zone.",
                           Duration = 3,
                           Image = "shield-alert"
                     })
                     Toggles.Toggle2:Set(false)
                     return
                  end

                  StartAutoPunch()

                  task.spawn(function()
                     local targetHum = targetObj.Character:FindFirstChild("Humanoid")
                     
                     while _G.AutoPunch and targetObj.Character and targetObj.Character:FindFirstChild("HumanoidRootPart") and (targetHum and targetHum.Health > 0) do
                           local char = localPlayer.Character
                           if char and char:FindFirstChild("HumanoidRootPart") then
                              char.HumanoidRootPart.CFrame = targetObj.Character.HumanoidRootPart.CFrame
                           end
                           task.wait()
                     end

                     if _G.AutoPunch and localPlayer.Character and localPlayer.Character:FindFirstChild("HumanoidRootPart") then
                        localPlayer.Character.HumanoidRootPart.CFrame = SafeCFrame
                        _G.AutoPunch = false
                        Toggles.Toggle2:Set(false)
                        Rayfield:Notify({
                           Title = "Target Eliminated!",
                           Content = "Target has been eliminated.",
                           Duration = 3,
                           Image = "skull"
                        })
                     end
                  end)
               else
                  Rayfield:Notify({
                     Title = "Error",
                     Content = "Target player or character not found.",
                     Duration = 3,
                     Image = "x"
                  })
                  Toggles.Toggle2:Set(false)
               end
         end
      end,
   })

   Dividers.Divider2 = Tab5:CreateDivider()

   Buttons.Button2 = Tab5:CreateButton({
   Name = "Teleport To The Selected Player",
   Callback = function()
      if not SelectedPlayer then
         return 
         Rayfield:Notify({
            Title = "Error",
            Content = "Please select a player first.",
            Duration = 3,
            Image = "x"
         })
      end

      local target = game:GetService("Players"):FindFirstChild(SelectedPlayer)
      local LocalPlayer = game:GetService("Players").LocalPlayer

      if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") and LocalPlayer.Character then
         LocalPlayer.Character.HumanoidRootPart.CFrame = target.Character.HumanoidRootPart.CFrame
      else
         Rayfield:Notify({
            Title = "Error",
            Content = "Target player or character not found.",
            Duration = 3,
            Image = "x"
         })
      end
   end,
   })

   Buttons.Button3 = Tab5:CreateButton({
      Name = "Tween To The Selected Player",
      Callback = function()
         if not SelectedPlayer then
            return 
            Rayfield:Notify({
               Title = "Error",
               Content = "Please select a player first.",
               Duration = 3,
               Image = "x"
            })
         end

         local target = game:GetService("Players"):FindFirstChild(SelectedPlayer)
         local LocalPlayer = game:GetService("Players").LocalPlayer

         if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") and LocalPlayer.Character then
            local root = LocalPlayer.Character.HumanoidRootPart
            local distance = (root.Position - target.Character.HumanoidRootPart.Position).Magnitude
            
            local tweenTime = distance / 100 
            
            local tween = TweenService:Create(root, TweenInfo.new(tweenTime, Enum.EasingStyle.Linear), {
               CFrame = target.Character.HumanoidRootPart.CFrame
            })
            
            tween:Play()
         else
            Rayfield:Notify({
               Title = "Error",
               Content = "Target player or character not found.",
               Duration = 3,
               Image = "x"
            })
         end
      end,
   })

   local Tab6 = AgeOfHeroesWINDOW:CreateTab("Visuals", "eye-off")

   local Textboxes = {}

   local function SetLeaderstat(statName, value)
   local ls = LocalPlayer:FindFirstChild("leaderstats")
   if not ls then return end

   local stat = ls:FindFirstChild(statName)
   if not stat then return end

   if typeof(stat.Value) == "number" then
      local num = tonumber(value)
      if num then
         stat.Value = num
         end
      elseif typeof(stat.Value) == "string" then
         stat.Value = tostring(value)
      end
   end


   Textboxes.Textbox1 = Tab6:CreateInput({
   Name = "Fake Level",
   CurrentValue = "",
   PlaceholderText = "Type Here",
   RemoveTextAfterFocusLost = false,
   Flag = "Textboxes.Textbox1",
   Callback = function(Text)
      SetLeaderstat("Level", Text)
   end,
   })

   Textboxes.Textbox2 = Tab6:CreateInput({
   Name = "Fake Title",
   CurrentValue = "",
   PlaceholderText = "Type Here",
   RemoveTextAfterFocusLost = false,
   Flag = "Textboxes.Textbox2",
   Callback = function(Text)
      SetLeaderstat("Title", Text)
   end,
   })

   Textboxes.Textbox3 = Tab6:CreateInput({
   Name = "Fake Reputation",
   CurrentValue = "",
   PlaceholderText = "Type Here",
   RemoveTextAfterFocusLost = false,
   Flag = "Textboxes.Textbox4",
   Callback = function(Text)
      SetLeaderstat("Reputation", Text)
   end,
   })

   Textboxes.Textbox4 = Tab6:CreateInput({
   Name = "Fake Money",
   CurrentValue = "",
   PlaceholderText = "Type Here",
   RemoveTextAfterFocusLost = false,
   Flag = "Textboxes.Textbox5",
   Callback = function(Text)
      SetLeaderstat("Money", Text)
   end,
   })

   local Tab7 = AgeOfHeroesWINDOW:CreateTab("Localplayer", "person-standing")

   local Textboxes = {}

   local Toggles = {}

   local WalkSpeedValue = 16
   local JumpPowerValue = 50

   local WalkToggle = false
   local JumpToggle = false

   local function GetHumanoid()
      local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
      return char:WaitForChild("Humanoid")
   end

   Textboxes.Textbox1 = Tab7:CreateInput({
      Name = "Change Your Walking Speed",
      CurrentValue = "",
      PlaceholderText = "Default: 16",
      RemoveTextAfterFocusLost = true,
      Flag = "Textboxes.Textbox1",
      Callback = function(Text)
         local num = tonumber(Text)
         if not num then return end

         WalkSpeedValue = num
         GetHumanoid().WalkSpeed = num
      end,
   })

   Toggles.Toggle1 = Tab7:CreateToggle({
      Name = "Lock WalkSpeed",
      CurrentValue = false,
      Flag = "Toggles.Toggle1",
      Callback = function(Value)
         WalkToggle = Value

         if Value then
               task.spawn(function()
                  while WalkToggle do
                     GetHumanoid().WalkSpeed = WalkSpeedValue
                     task.wait(0.2)
                  end
               end)
         end
      end,
   })

   Textboxes.Textbox2 = Tab7:CreateInput({
      Name = "Change Your Jump Height",
      CurrentValue = "",
      PlaceholderText = "Default: 50",
      RemoveTextAfterFocusLost = true,
      Flag = "Textboxes.Textbox2",
      Callback = function(Text)
         local num = tonumber(Text)
         if not num then return end

         JumpPowerValue = num
         GetHumanoid().JumpPower = num
      end,
   })

   Toggles.Toggle2 = Tab7:CreateToggle({
      Name = "Lock JumpPower",
      CurrentValue = false,
      Flag = "Toggles.Toggle2",
      Callback = function(Value)
         JumpToggle = Value

         if Value then
               task.spawn(function()
                  while JumpToggle do
                     GetHumanoid().JumpPower = JumpPowerValue
                     task.wait(0.2)
                  end
               end)
         end
      end,
   })

   local Tab8 = AgeOfHeroesWINDOW:CreateTab("Server Information", "info")

   local STAT_NAMES = { "Money", "Reputation", "Level" }
   local PlayerUI = {}

   local function ShortenNumber(n)
      n = tonumber(n)
      if not n then return "?" end

      local abs = math.abs(n)
      local sign = n < 0 and "-" or ""

      local function fmt(div, suf)
         local v = abs / div
         local s = string.format("%.2f", v)
         s = s:gsub("%.?0+$", "")
         return sign .. s .. suf
      end

      if abs >= 1e12 then
         return fmt(1e12, "T")
      elseif abs >= 1e9 then
         return fmt(1e9, "B")
      elseif abs >= 1e6 then
         return fmt(1e6, "M")
      elseif abs >= 1e3 then
         return fmt(1e3, "K")
      else
         return tostring(n)
      end
   end

   local function DisconnectAll(conns)
      if not conns then return end
      for _, c in ipairs(conns) do
         pcall(function() c:Disconnect() end)
      end
   end

   local function GetLeaderstats(player)
      return player:FindFirstChild("leaderstats")
   end

   local function FormatPlayerLine(player)
      local ls = GetLeaderstats(player)
      local parts = {}

      for _, statName in ipairs(STAT_NAMES) do
         local v = "?"
         if ls then
            local stat = ls:FindFirstChild(statName)
            if stat and stat.Value ~= nil then
               if typeof(stat.Value) == "number" then
                  v = ShortenNumber(stat.Value)
               else
                  v = tostring(stat.Value)
               end
            end
         end
         parts[#parts + 1] = statName .. ": " .. v
      end

      return player.Name .. " | " .. table.concat(parts, " | ")
   end

   local function UpdatePlayerLabel(player)
      local info = PlayerUI[player]
      if not info or not info.Label then return end
      info.Label:Set(FormatPlayerLine(player))
   end

   local function AttachLeaderstatsWatch(player)
      local info = PlayerUI[player]
      if not info then return end

      local ls = GetLeaderstats(player)
      if not ls then return end

      if info.LeaderstatsRef == ls then
         UpdatePlayerLabel(player)
         return
      end

      info.LeaderstatsRef = ls

      if info.StatConns then
         DisconnectAll(info.StatConns)
      end
      info.StatConns = {}

      local function HookStat(stat)
         if not stat or not stat.Changed then return end
         local c = stat.Changed:Connect(function()
            UpdatePlayerLabel(player)
         end)
         info.StatConns[#info.StatConns + 1] = c
      end

      for _, statName in ipairs(STAT_NAMES) do
         HookStat(ls:FindFirstChild(statName))
      end

      local childAddedConn = ls.ChildAdded:Connect(function(ch)
         for _, statName in ipairs(STAT_NAMES) do
            if ch.Name == statName then
               UpdatePlayerLabel(player)
               HookStat(ch)
               break
            end
         end
      end)
      info.Conns[#info.Conns + 1] = childAddedConn

      UpdatePlayerLabel(player)
   end

   local function CreatePlayerRow(player)
      if PlayerUI[player] then
         UpdatePlayerLabel(player)
         AttachLeaderstatsWatch(player)
         return
      end

      local label = Tab8:CreateLabel("Loading...", "tally-1")
      PlayerUI[player] = {
         Label = label,
         Conns = {},
         StatConns = {},
         LeaderstatsRef = nil
      }

      UpdatePlayerLabel(player)

      local childAddedConn = player.ChildAdded:Connect(function(ch)
         if ch.Name == "leaderstats" then
            AttachLeaderstatsWatch(player)
         end
      end)
      PlayerUI[player].Conns[#PlayerUI[player].Conns + 1] = childAddedConn

      AttachLeaderstatsWatch(player)
   end

   local function RemovePlayerRow(player)
      local info = PlayerUI[player]
      if not info then return end

      DisconnectAll(info.Conns)
      DisconnectAll(info.StatConns)

      pcall(function()
         if info.Label and info.Label.Destroy then
            info.Label:Destroy()
         end
      end)

      PlayerUI[player] = nil
   end

   for _, plr in ipairs(Players:GetPlayers()) do
      CreatePlayerRow(plr)
   end

   Players.PlayerAdded:Connect(function(plr)
      CreatePlayerRow(plr)
   end)

   Players.PlayerRemoving:Connect(function(plr)
      RemovePlayerRow(plr)
   end)

   local Tab9 = AgeOfHeroesWINDOW:CreateTab("Misc", "ellipsis")

   local Labels = {}

   local Dividers = {}

   local Toggles = {}

   local Buttons = {}
   
   local Keybinds = {}

   local StartTime = os.clock()

   Labels.Label1 = Tab9:CreateLabel("Script Time:", "clock")
   
   task.spawn(function()
      while true do
        local elapsed = math.floor(os.clock() - StartTime)

        local hours = math.floor(elapsed / 3600)
        local minutes = math.floor((elapsed % 3600) / 60)
        local seconds = elapsed % 60

        local text = "Script Time: "

        if hours > 0 then
            text ..= hours .. " Hour"
            if hours > 1 then text ..= "s" end
            text ..= " "
        end

        if minutes > 0 then
            text ..= minutes .. " Minute"
            if minutes > 1 then text ..= "s" end
            text ..= " "
        end

        text ..= seconds .. " Second"
        if seconds ~= 1 then text ..= "s" end

        Labels.Label1:Set(text)

        task.wait(1)
      end
   end)

   Dividers.Divider1 = Tab9:CreateDivider()

   local VirtualUser = game:GetService("VirtualUser")
   local NoAFK = false

   Toggles.Toggle1 = Tab9:CreateToggle({
   Name = "No AFK",
   CurrentValue = false,
   Flag = "Toggles.Toggle1",
   Callback = function(Value)
      NoAFK = Value

         if Value then
            task.spawn(function()
               while NoAFK do
                  VirtualUser:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
                  task.wait(1)
                  VirtualUser:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
                  task.wait(30)
               end
            end)
         end
   end,
   })

   local NotifyToggle = false

   local joinConnection
   local leaveConnection

   Toggles.Toggle2 = Tab9:CreateToggle({
   Name = "Player Joined/Left Notifications",
   CurrentValue = false,
   Flag = "Toggles.Toggle2",
   Callback = function(Value)
      NotifyToggle = Value

        if Value then
            joinConnection = Players.PlayerAdded:Connect(function(player)
               Rayfield:Notify({
                  Title = "Player Joined",
                  Content = player.Name .. " joined the game",
                  Duration = 3,
                  Image = "log-in"
               })
            end)

            leaveConnection = Players.PlayerRemoving:Connect(function(player)
                  Rayfield:Notify({
                     Title = "Player left",
                     Content = player.Name .. " left the game",
                     Duration = 3,
                     Image = "log-out"
                  })
            end)
        else
            if joinConnection then
                joinConnection:Disconnect()
                joinConnection = nil
            end

            if leaveConnection then
                leaveConnection:Disconnect()
                leaveConnection = nil
            end
        end
   end,
   })

   Dividers.Divider2 = Tab9:CreateDivider()

   local function ServerHop()
      local servers = {}
      local cursor = ""

      repeat
         local url = "https://games.roblox.com/v1/games/" .. PlaceId ..
               "/servers/Public?sortOrder=Asc&limit=100" ..
               (cursor ~= "" and "&cursor=" .. cursor or "")

         local success, result = pcall(function()
               return HttpService:JSONDecode(game:HttpGet(url))
         end)

         if success and result and result.data then
               for _, server in ipairs(result.data) do
                  if server.playing < server.maxPlayers and server.id ~= game.JobId then
                     table.insert(servers, server.id)
                  end
               end
               cursor = result.nextPageCursor or ""
         else
               break
         end
      until cursor == "" or #servers > 0

      if #servers > 0 then
         TeleportService:TeleportToPlaceInstance(PlaceId, servers[math.random(1, #servers)], LocalPlayer)
      else
         Rayfield:Notify({
            Title = "Server Hop",
            Content = "No available server found.",
            Duration = 3
         })
      end
   end

   Buttons.Button1 = Tab9:CreateButton({
   Name = "Server Hop",
   Callback = function()
      Rayfield:Notify({
         Title = "Server Hop",
         Content = "Searching for a new server...",
         Duration = 3,
         Image = "search"
      })

      ServerHop()
   end,
   })

   local function RejoinServer()
      TeleportService:TeleportToPlaceInstance(
      game.PlaceId,
      game.JobId,
      LocalPlayer
      )
   end

   Buttons.Button2 = Tab9:CreateButton({
   Name = "Rejoin Server",
   Callback = function()
      Rayfield:Notify({
         Title = "Rejoin",
         Content = "Rejoining current server...",
         Duration = 3,
         Image = "plug-zap"
      })

      RejoinServer()
   end,
   })

   Dividers.Divider3 = Tab9:CreateDivider()

   Keybinds.Keybind1 = Tab9:CreateKeybind({
   Name = "Auto Punch Keybind",
   CurrentKeybind = "T",
   HoldToInteract = false,
   Flag = "Keybinds.Keybind1",
   Callback = function(Keybind)
      _G.AutoPunch = not _G.AutoPunch
      if _G.AutoPunch then
         StartAutoPunch()
      end
   end,
   })

   Dividers.Divider4 = Tab9:CreateDivider()

   Buttons.Button4 = Tab9:CreateButton({
   Name = "Click To Teleport Tool",
   Callback = function()
      local player = game:GetService("Players").LocalPlayer
      local mouse = player:GetMouse()
      local tool = Instance.new("Tool")
      
      tool.Name = "TP Tool"
      tool.RequiresHandle = false
      
      tool.Activated:Connect(function()
         local pos = mouse.Hit.p
         local char = player.Character
         if char and char:FindFirstChild("HumanoidRootPart") then
            char.HumanoidRootPart.CFrame = CFrame.new(pos + Vector3.new(0, 3, 0))
         end
      end)
      
      tool.Parent = player.Backpack
   end,
   })

   Buttons.Button5 = Tab9:CreateButton({
   Name = "Remove Current Tools",
   Callback = function()
      for _, tool in ipairs(LocalPlayer.Backpack:GetChildren()) do
         if tool:IsA("Tool") then
            tool:Destroy()
         end
      end

      if LocalPlayer.Character then
         for _, tool in ipairs(LocalPlayer.Character:GetChildren()) do
            if tool:IsA("Tool") then
               tool:Destroy()
            end
         end
      end
   end,
   })

   Dividers.Divider5 = Tab9:CreateDivider()

   Buttons.Button6 = Tab9:CreateButton({
   Name = "Our Discord Server",
   Callback = function()
      setclipboard("https://discord.gg/p3W9x232FD")
      Rayfield:Notify({
         Title = "Success!",
         Content = "The server link has been copied successfully.",
         Duration = 5,
         Image = "check"
      })
   end,
   })

   Buttons.Button7 = Tab9:CreateButton({
   Name = "Destroy Kak.Hub",
   Callback = function()
      Rayfield:Destroy()
   end,
   })

end
